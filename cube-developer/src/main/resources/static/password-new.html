<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8"/>
		<title>魔方</title>
		<link rel="stylesheet" type="text/css" href="/css/common.css"/>
		<link rel="stylesheet" type="text/css" href="/css/float.css"/>
		<link rel="stylesheet" type="text/css" href="/css/mf-nav-footer.css"/>
		<link rel="stylesheet" type="text/css" href="/css/password-new.css"/>
		<script type="text/javascript" src="/js/jquery-1.11.0.js"></script>
	</head>
	<body>
		<!--导航栏开始-->
		<div id="mf-nav">
			<div class="mf-header-nav">
				<img class="mf-header-nav-img" src="/img/logo.png"/>
				<div class="mf-header-nav-text right_float clear_by_after">
					<a class="mf-a-1 a-current">首页</a>
					<a>价格</a>
					<a>下载</a>
					<a>开发守则</a>
					<a>开发者社区</a>
					<a>关于我们</a>
					<a>登录&nbsp;·&nbsp;注册</a>
				</div>
			</div>
		</div>
		<!--导航栏结束-->
		
		<!--内容区域开始-->
		<div id="mf-main">
			<div class="mf-content">
				<div class="mf-area">
					<ul class="children_left_float">
						<li class=""><img src="/img/3_03.png"/></li>
						<li class="mf-wire"><img src="/img/3.1_05.png"/></li>
						<li><img src="/img/3_03.png"/></li>
						<li class="mf-wire"><img src="/img/3.1_05.png"/></li>
						<li><img src="/img/3_03.png"/></li>
					</ul>


					<ul class="children_left_float mf-text">
						<li class="">输入账号</li>
						<li>安全验证</li>
						<li>设置新密码</li>
					</ul>

					<p><span>新密码</span><input type="text" name="" id="pwd" value="" placeholder="请输入新密码" /></p>
					<p><span>确认新密码</span><input type="text" name="" id="pwdConfirm" value="" placeholder="请确认新密码" /></p>
					<div th:switch="${code}" id="submit">
						<p th:case="200">完成</p>
						<p th:case="500">无效链接</p>
					</div>
					<input type="hidden" id="actmd5" th:value="key"/>
				</div>
			</div>
		</div>
		
		<!--底部开始-->
		<div id="mf-footer">
			<div class="mf-content children_left_float">
				<div class="mf-footer-firstdiv">
					<p><span>Tel：010-84922996</span><span>Mail：service@shixinyun.com</span><span>QQ：2161045552</span></p>
					<p>公司简介&emsp;|&emsp;团队介绍&emsp;|&emsp;联系方式&emsp;|&emsp;加入我们&emsp;|&emsp;服务支持&emsp;|&emsp;服务条款</p>
					<p>SDK下载&emsp;|&emsp;开发者手册&emsp;|&emsp;知识库</p>
				</div>
				<div class="mf-footer-lastdiv">
					<img src="/img/img_foot_logo.png"/>
					<p>版权所有 © 2014-2016 北京时信互联网络科技有限公司 京ICP备16000263号-1</p>
				</div>
			</div>
		</div>
		<!--底部结束-->
		
	</body>

	<script th:inline="javascript">
		/*<![CDATA[*/
		$(function () {

			$("#submit").on("click",function () {

				var notic=$(this).find("p").html();
				if(notic=="无效链接"){
					alert("无效链接");
					return;
				}
				var actmd5=$("#actmd5").val();
				var pwd =$("#pwd").val();
				var pwdConfirm =$("#pwdConfirm").val();
				if(pwd!=pwdConfirm){
					alert("两次密码不一致");
					return;
				}

				if(pwd.length < 6){
					alert("密码长度不能少于6位");
					return;
				}

				$.ajax({
					url:"/auth/password/mailupdate",
					data:{"newPwd":pwd,"actmd5":actmd5},
					async:false,
					type : 'post',
					dataType : 'json',
					success:function(data){
						if(data.code==10012){
							alert("链接已失效");
						}else if(data.code==100){
							alert("未知错误");
						}
					},
					error:function () {
						alert("未知错误");
					}
				})

			});
		})
		/*]]>*/
	</script>
</html>
